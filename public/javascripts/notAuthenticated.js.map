{"version":3,"sources":["notAuthenticated.js"],"names":["location","pathname","includes","btn","document","getElementById","remove","onclick","event","preventDefault","email","value","password","fetch","method","redirect","cache","credentials","headers","body","JSON","stringify","logInRes","status","json","err","msg","message","toString","console","error","alert","sessionStorage","clear","dispatchEvent","Event","setItem","result","setCookie","token","href","burger","querySelector","menu","classList","contains","add"],"mappings":"0YAAA,GAAIA,QAAQ,CAACC,QAAT,CAAkBC,QAAlB,CAA2B,gBAA3B,CAAJ,CAAkD,CAChD,GAAMC,CAAAA,GAAG,CAAGC,QAAQ,CAACC,cAAT,CAAwB,8BAAxB,CAAZ,CACIF,GAF4C,EAEvCA,GAAG,CAACG,MAAJ,EACV,CAGD,CAAC,UAAW,CACV,GAAIH,CAAAA,CAAG,CAAGC,QAAQ,CAACC,cAAT,CAAwB,mBAAxB,CAAV,CACKF,CAFK,GAGVA,CAAG,CAACI,OAAJ,sFAAc,WAAOC,CAAP,uGAGZA,CAAAA,CAAK,CAACC,cAAN,EAHY,CAKNC,CALM,CAKEN,QAAQ,CAACC,cAAT,CAAwB,oBAAxB,EAA8CM,KALhD,CAMNC,CANM,CAMKR,QAAQ,CAACC,cAAT,CAAwB,uBAAxB,EAAiDM,KANtD,UAOWE,KAAK,CAAC,iBAAD,CAAoB,CAC9CC,MAAM,CAAE,MADsC,CAE9CC,QAAQ,CAAE,QAFoC,CAG9CC,KAAK,CAAE,UAHuC,CAI9CC,WAAW,CAAE,SAJiC,CAK9CC,OAAO,CAAE,CACP,eAAgB,kBADT,CAEP,OAAU,kBAFH,CALqC,CAS9CC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,CAACX,KAAK,CAALA,CAAD,CAAQE,QAAQ,CAARA,CAAR,CAAf,CATwC,CAApB,CAPhB,WAONU,CAPM,UAmBW,GAAnB,EAAAA,CAAQ,CAACC,MAnBD,6CAqBUD,CAAQ,CAACE,IAAT,EArBV,eAqBFC,CAAAA,CArBE,QAsBFC,CAtBE,CAsBID,CAAG,CAACC,GAAJ,EAAWD,CAAG,CAACE,OAAf,EAA0BF,CAAG,CAACG,QAAJ,EAtB9B,CAuBRC,OAAO,CAACC,KAAR,CAAcJ,CAAd,CAvBQ,mBAwBDK,KAAK,CAACL,CAAD,CAxBJ,8CA0BRG,OAAO,CAACC,KAAR,MA1BQ,mBA2BDC,KAAK,MA3BJ,qCAkCGT,CAAQ,CAACE,IAAT,EAlCH,SAkCVA,CAlCU,qEAoCVK,OAAO,CAACC,KAAR,MApCU,CAqCVE,cAAc,CAACC,KAAf,EArCU,mBAsCH7B,QAAQ,CAACC,cAAT,CAAwB,mBAAxB,EAA6C6B,aAA7C,CAA2D,GAAIC,CAAAA,KAAJ,CAAU,OAAV,CAA3D,CAtCG,UAyCZH,cAAc,CAACI,OAAf,CAAuB,UAAvB,CAAmChB,IAAI,CAACC,SAAL,CAAeG,CAAI,CAACa,MAApB,CAAnC,CAzCY,CA0CZC,SAAS,CAAC,OAAD,CAAUd,CAAI,CAACa,MAAL,CAAYE,KAAtB,CA1CG,CA2CZvC,QAAQ,CAACwC,IAAT,CAAgBxC,QAAQ,CAACC,QAAT,CAAkBC,QAAlB,CAA2B,WAA3B,EACZ,YADY,CAEZF,QAAQ,CAACwC,IA7CD,+DAAd,uDAHU,CAkDX,CAlDD,G,CAoDC,UAAW,CACV,GAAIC,CAAAA,CAAM,CAAGrC,QAAQ,CAACsC,aAAT,CAAuB,uBAAvB,CAAb,CACKD,CAFK,GAGVA,CAAM,CAAClC,OAAP,CAAiB,UAAM,CACrB,GAAMoC,CAAAA,CAAI,CAAGvC,QAAQ,CAACsC,aAAT,CAAuB,cAAvB,CAAb,CAEA,MAAOC,CAAAA,CAAI,CAACC,SAAL,CAAeC,QAAf,CAAwB,WAAxB,EACHF,CAAI,CAACC,SAAL,CAAetC,MAAf,CAAuB,WAAvB,CADG,CAEHqC,CAAI,CAACC,SAAL,CAAeE,GAAf,CAAmB,WAAnB,CACL,CATS,CAUX,CAVD,E","sourcesContent":["if (location.pathname.includes('/user/register')) {\n  const btn = document.getElementById('layout-btn-register-redirect');\n  if (btn) btn.remove();\n}\n\n\n(function() {\n  let btn = document.getElementById('layout-btn-log-in');\n  if (!btn) return;\n  btn.onclick = async (event) => {\n\n    // don't send the HTML form\n    event.preventDefault();\n\n    const email = document.getElementById('layout-input-email').value;\n    const password = document.getElementById('layout-input-password').value;\n    const logInRes = await fetch('/api/user/login', {\n      method: 'POST',\n      redirect: 'follow',\n      cache: 'no-cache',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json',\n      },\n      body: JSON.stringify({email, password}),\n    });\n\n    if (logInRes.status >= 400) {\n      try {\n        const err = await logInRes.json();\n        const msg = err.msg || err.message || err.toString();\n        console.error(msg);\n        return alert(msg);\n      } catch (e) {\n        console.error(e);\n        return alert(e);\n      }\n    }\n\n    let json;\n\n    try {\n      json = await logInRes.json();\n    } catch (e) {\n      console.error(e);\n      sessionStorage.clear();\n      return document.getElementById('layout-btn-log-in').dispatchEvent(new Event('click'));\n    }\n\n    sessionStorage.setItem('loggedIn', JSON.stringify(json.result));\n    setCookie('token', json.result.token);\n    location.href = location.pathname.includes('/register')\n      ? '/user/home'\n      : location.href;\n  };\n})();\n\n(function() {\n  let burger = document.querySelector(\".navbar-burger.burger\");\n  if (!burger) return;\n  burger.onclick = () => {\n    const menu = document.querySelector('.navbar-menu');\n\n    return menu.classList.contains('is-active')\n      ? menu.classList.remove( 'is-active')\n      : menu.classList.add('is-active');\n  };\n})();\n\n"]}