{"version":3,"sources":["view.js"],"names":["unEnroll","moduleId","fetch","redirect","cache","method","credentials","headers","Accept","response","status","json","msg","message","toString","console","error","alert","enrollBtn","document","getElementById","classList","remove","add","innerHTML","onclick","setTimeout","enroll","body","JSON","stringify","nameEl","innerText","trim","topicEl","lesson","querySelectorAll","getAttribute","querySelector"],"mappings":"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","sourcesContent":["async function unEnroll(moduleId) {\n  try {\n    const response = await fetch(`/api/enrollment/${moduleId}`, {\n      redirect: 'follow',\n      cache: 'no-cache',\n      method: 'delete',\n      credentials: 'include',\n      headers: {Accept: 'application/json'},\n    });\n    if (response.status >= 400) {\n      const json = await response.json();\n      const msg = json.msg || json.message || json.toString();\n      console.error(msg);\n      return alert(msg);\n    }\n    const enrollBtn = document.getElementById('module-btn-enroll');\n    enrollBtn.classList.remove('is-danger');\n    enrollBtn.classList.add('is-light');\n    enrollBtn.innerHTML = `\n    <i class=\"fas fa-hourglass-half\" style=\"margin-right: 7px;\"></i>\n    Wait `;\n    enrollBtn.onclick = undefined;\n    return setTimeout(() => {\n      enrollBtn.classList.remove('is-light');\n      enrollBtn.classList.add('is-primary');\n      enrollBtn.innerHTML = `\n        <i class=\"fas fa-check\" style=\"margin-right: 7px;\"></i>\n        Enroll`;\n      enrollBtn.onclick = () => enroll(moduleId);\n    }, 1000);\n  } catch (e) {\n    const msg = e.msg || e.message || e.toString();\n    console.error(msg);\n    return alert(msg);\n  }\n}\n\nasync function enroll(moduleId) {\n  try {\n    const response = await fetch(`/api/enrollment/create`, {\n      method: 'post',\n      redirect: 'follow',\n      cache: 'no-cache',\n      credentials: 'include',\n      body: JSON.stringify({moduleId}),\n      headers: {\n        'Content-Type': 'application/json',\n        Accept: 'application/json',\n      },\n    });\n    if (response.status >= 400) {\n      const json = await response.json();\n      const msg = json.msg || json.message || json.toString();\n      console.error(msg);\n      return alert(msg);\n    }\n    const enrollBtn = document.getElementById('module-btn-enroll');\n    enrollBtn.classList.remove('is-primary');\n    enrollBtn.classList.add('is-light');\n    enrollBtn.innerHTML = `\n      <i class=\"fas fa-hourglass-half\" style=\"margin-right: 7px;\"></i>\n      wait`;\n    enrollBtn.onclick = undefined;\n    return setTimeout(() => {\n      enrollBtn.classList.remove('is-light');\n      enrollBtn.classList.add('is-danger');\n      enrollBtn.innerHTML = `\n        <i class=\"fas fa-times\" style=\"margin-right: 7px;\"></i>\n        Unenroll`;\n      enrollBtn.onclick = () => unEnroll(moduleId);\n    }, 1000);\n  } catch (e) {\n    const msg = e.msg || e.message || e.toString();\n    console.error(msg);\n    return alert(msg);\n  }\n}\n\n(() => {\n  const nameEl = document.getElementById('module-h-name');\n  if (nameEl.innerText.trim() === '') {\n    nameEl.innerText = 'Unnamed';\n  }\n  const topicEl = document.getElementById('module-h-topic');\n  if (topicEl.innerText.trim() === '') {\n    topicEl.innerText = 'No Topic';\n  }\n})();\n\n\nfor (const lesson of document.querySelectorAll('#module-lessons li a')) {\n  if (lesson.innerText.trim() === '') {\n    lesson.innerText = `unnamed #${lesson.getAttribute('data-id')}`;\n  }\n  // lesson.onclick = async function(event) {\n  //   event.preventDefault();\n  //   const response = await fetch(\n  //     location.pathname + `/${lesson.getAttribute('data-id')}`, {\n  //       redirect: 'follow',\n  //       cache: 'no-cache',\n  //       credentials: 'include',\n  //     });\n  //   return response.status >= 400\n  //     ? alert('you need to enroll')\n  //     : (location.pathname += `/${lesson.getAttribute('data-id')}`);\n  // };\n}\n\ndocument.querySelector('pre').innerHTML = document.querySelector('pre').innerHTML.trim();\n\n"]}