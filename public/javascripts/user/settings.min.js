"use strict";function asyncGeneratorStep(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){return void c(a)}h.done?b(i):Promise.resolve(i).then(d,e)}function _asyncToGenerator(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){function f(a){asyncGeneratorStep(h,d,e,f,g,"next",a)}function g(a){asyncGeneratorStep(h,d,e,f,g,"throw",a)}var h=a.apply(b,c);f(void 0)})}}document.getElementById("user-btn-modify-details").onclick=/*#__PURE__*/function(){var a=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function a(b){var c,d,e,f,g,h,i,j,l,m,n,o,p,q,r,s,t,u,v,w,x;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:for(a.prev=0,b.preventDefault(),c={},d=[],e=document.getElementById("user-input-email"),c.email=e.value,f=document.getElementById("user-info"),c.info=""===f.value?null:f.value,g=document.getElementById("user-first-name"),c.firstName=""===g.value?null:g.value,h=document.getElementById("user-last-name"),c.lastName=""===h.value?null:h.value,i=Object.keys(c),j=0;j<i.length;j++)l=i[j],d.push(l);return a.next=16,fetch("/api/user",{method:"POST",withCredentials:!0,cache:"no-cache",body:JSON.stringify(c),redirect:"follow",mode:"cors",headers:{"Content-Type":"application/json",Accept:"application/json"}});case 16:if(m=a.sent,!(400<=m.status)){a.next=24;break}return a.next=20,m.json();case 20:return n=a.sent,o=n.msg||n.message||n.toString(),console.error(o),a.abrupt("return",alert(o));case 24:return a.next=26,m.json();case 26:if(p=a.sent,q=document.getElementById("user-password-old"),r=document.getElementById("user-input-email"),!(""===r.value||0>=r.value.indexOf("@")||4>=r.value.length)){a.next=31;break}return a.abrupt("return",alert("bad email format, cannot change password"));case 31:if(s=document.getElementById("user-password-new"),t=document.getElementById("user-password-new-2"),![q,s,t].reduce(function(a,b){return""===b.value&&a},!0)){a.next=35;break}return a.abrupt("return",alert("successfully modified ".concat(d.join(", "))));case 35:if(d.push("password"),![q,s,t].reduce(function(a,b){return a||""===b.value},!1)){a.next=38;break}return a.abrupt("return",alert("empty password"));case 38:if(s.value===t.value){a.next=40;break}return a.abrupt("return",alert("new passwords don't match"));case 40:if(s.value!==q.value){a.next=42;break}return a.abrupt("return",alert("old and new password are exactly the same"));case 42:return a.next=44,fetch("/api/user/password",Object.assign({method:"POST",withCredentials:!0,cache:"no-cache",body:JSON.stringify(c),redirect:"follow",mode:"cors",headers:{"Content-Type":"application/json",Accept:"application/json"}},{body:JSON.stringify({value:s.value,password:q.value,email:r.value})}));case 44:if(u=a.sent,!(400<=u.status)){a.next=54;break}return a.next=48,u.json();case 48:return v=a.sent,w=v.msg||v.message||v.toString(),console.error(w),a.abrupt("return",alert(w));case 54:alert("successfully modified ".concat(d.join(", ")));case 55:a.next=62;break;case 57:return a.prev=57,a.t0=a["catch"](0),x=a.t0.msg||a.t0.message||a.t0.toString(),console.error(x),a.abrupt("return",alert(x));case 62:case"end":return a.stop();}},a,this,[[0,57]])}));return function(){return a.apply(this,arguments)}}();