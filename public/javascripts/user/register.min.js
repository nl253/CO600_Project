"use strict";function asyncGeneratorStep(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){return void c(a)}h.done?b(i):Promise.resolve(i).then(d,e)}function _asyncToGenerator(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){function f(a){asyncGeneratorStep(h,d,e,f,g,"next",a)}function g(a){asyncGeneratorStep(h,d,e,f,g,"throw",a)}var h=a.apply(b,c);f(void 0)})}}document.getElementById("reg-password-2").oninput=function(){var a=document.getElementById("reg-password");this.style.background=a.value===this.value?"#e7fdd1":"#ffbaba",a.style.background=a.value===this.value?"#e7fdd1":"#ffbaba"},document.getElementById("reg-btn").onclick=/*#__PURE__*/function(){var a=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function a(b){var c,d;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:// Ask to set cookie
b.preventDefault(),c=document.querySelector(".modal"),d=document.querySelector("html"),c.classList.add("is-active"),d.classList.add("is-clipped"),c.querySelector(".modal-background").addEventListener("click",function(a){a.preventDefault(),c.classList.remove("is-active"),d.classList.remove("is-clipped")}),document.getElementById("register-allowCookies-btn").onclick=/*#__PURE__*/function(){var a=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function a(){var b,c,d,e,f,g,h,i,j,k,l;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(b={email:document.getElementById("reg-email").value.trim(),password:document.getElementById("reg-password").value.trim()},document.getElementById("reg-password-2").value===b.password){a.next=3;break}return a.abrupt("return",alert("passwords don't match"));case 3:return c=document.getElementById("reg-first-name").value.trim(),""!==c&&(b.firstName=c),d=document.getElementById("reg-last-name").value.trim(),""!==d&&(b.lastName=d),a.prev=7,a.next=10,fetch("/api/user/register",{method:"post",redirect:"follow",cache:"no-cache",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(b)});case 10:if(e=a.sent,!(400<=e.status)){a.next=19;break}return console.error(e),a.next=15,e.json();case 15:return f=a.sent,g=f.msg||f.message||f.toString(),console.error(g),a.abrupt("return",alert(g));case 19:return a.next=21,fetch("/api/user/login",{method:"post",redirect:"follow",cache:"no-cache",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:b.email,password:b.password})});case 21:if(h=a.sent,!(400<=h.status)){a.next=29;break}return a.next=25,h.json();case 25:return i=a.sent,j=i.msg||i.message||i.toString(),console.error(j),a.abrupt("return",alert(j));case 29:return a.next=31,h.json();case 31:k=a.sent,sessionStorage.setItem("loggedIn",JSON.stringify(k.result)),setCookie("token",k.result.token),location.pathname=location.pathname.endsWith("/register")?"/":location.pathname,a.next=42;break;case 37:return a.prev=37,a.t0=a["catch"](7),l=a.t0.msg||a.t0.message||a.t0.toString(),console.error(a.t0),a.abrupt("return",alert(l));case 42:case"end":return a.stop();}},a,this,[[7,37]])}));return function(){return a.apply(this,arguments)}}();case 7:case"end":return a.stop();}},a,this)}));return function(){return a.apply(this,arguments)}}();