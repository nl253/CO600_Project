"use strict";function asyncGeneratorStep(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){return void c(a)}h.done?b(i):Promise.resolve(i).then(d,e)}function _asyncToGenerator(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){function f(a){asyncGeneratorStep(h,d,e,f,g,"next",a)}function g(a){asyncGeneratorStep(h,d,e,f,g,"throw",a)}var h=a.apply(b,c);f(void 0)})}}var SECOND=1e3,MINUTE=60000,HOUR=60*MINUTE;/**
 * Returns the value of a cookie.
 *
 * @param {!String} name
 * @return {?String} cookie value
 */function getCookie(a){var b=document.cookie.split(";").map(function(a){return a.trim()}).map(function(a){return a.split("=")}).map(function(a){return a.map(decodeURIComponent)}),c={},d=!0,e=!1,f=void 0;try{for(var g,h,i=b[Symbol.iterator]();!(d=(g=i.next()).done);d=!0)h=g.value,c[h[0]]=h[1]}catch(a){e=!0,f=a}finally{try{d||null==i.return||i.return()}finally{if(e)throw f}}return c[a]}/**
 * Sets the value of a cookie.
 *
 * @param {!String} name
 * @param {{path: String, sameSite: 'Strict' | 'Lax', expires: Date}} opts
 * @param {!String} value
 */function setCookie(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},d=Object.assign({path:"/",httpOnly:!1,sameSite:"Strict"// expires: new Date(Date.now() + HOUR * 2),
},c);document.cookie=[[a,b].map(encodeURIComponent),// ['Expires', options.expires.toGMTString()],
["Path",d.path],["SameSite",d.sameSite]].map(function(a){return a.join("=")}).join("; ")}/**
 * Clears a cookie.
 *
 * @param {!String} name
 */function clearCookie(a){document.cookie="".concat(a,"=; expires=Thu, 01 Jan 1970 00:00:01 GMT")}/**
 * Query the database for objects.
 *
 * @param {'User', 'Module', 'Lesson', 'Question', 'Rating'} model
 * @param {!Object} query
 * @param {?Boolean} force
 * @return {Promise<!Array<{id: !Number, createdAt: !Date, updatedAt: !Date}>>}
 */function get(){return _get.apply(this,arguments)}/**
 * Create a new object in the database.
 *
 * @param {'User', 'Module', 'Lesson', 'Question', 'Rating'} model
 * @param {!Blob|!BufferSource|!FormData|!URLSearchParams|!ReadableStream|!String} [postData]
 * @return {Promise<void|{id: !Number, createdAt: !Date, updatedAt: !Date}>} created object
 */function _get(){return _get=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function a(b){var c,d,e,f,g,h,i=arguments;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(h=function(){var a=sessionStorage.getItem("".concat(location.pathname,"/").concat(b.toLowerCase(),"s?").concat(Object.entries(c).map(function(a){return a.join("=")}).join("&")));return!!a&&(console.debug("using cache for ".concat(b," with ").concat(Object.keys(c).join(", "))),JSON.parse(a))},g=function(){return g=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function a(){var d,f,g,h,i=arguments;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=0<i.length&&void 0!==i[0]?i[0]:e,a.prev=1,console.debug("using AJAX for ".concat(b," with ").concat(Object.keys(c).join(", "))),a.next=5,fetch("/api/".concat(b.toLowerCase(),"/search?").concat(Object.entries(c).map(function(a){return a.join("=")}).join("&")),{headers:{Accept:"application/json"},credentials:"include",redirect:"follow",cache:"no-cache"});case 5:return f=a.sent,a.next=8,f.json();case 8:return g=a.sent,d&&sessionStorage.setItem("".concat(location.pathname,"/").concat(b.toLowerCase(),"s?").concat(Object.entries(c).map(function(a){return a.join("=")}).join("&")),JSON.stringify(g.result)),a.abrupt("return",g.result);case 13:return a.prev=13,a.t0=a["catch"](1),h=a.t0.msg||a.t0.message||a.t0.toString(),console.error(h),a.abrupt("return",alert(h));case 18:case"end":return a.stop();}},a,this,[[1,13]])})),g.apply(this,arguments)},f=function(){return g.apply(this,arguments)},c=1<i.length&&void 0!==i[1]?i[1]:{},d=!(2<i.length&&void 0!==i[2])||i[2],e=!!(3<i.length&&void 0!==i[3])&&i[3],a.t2=d,!a.t2){a.next=11;break}return a.next=10,f();case 10:a.t2=a.sent;case 11:if(a.t1=a.t2,a.t1){a.next=14;break}a.t1=h();case 14:if(a.t0=a.t1,a.t0){a.next=19;break}return a.next=18,f();case 18:a.t0=a.sent;case 19:return a.abrupt("return",a.t0);case 20:case"end":return a.stop();}},a,this)})),_get.apply(this,arguments)}function create(){return _create.apply(this,arguments)}/**
 * Update an object in the database.
 *
 * @param {'User', 'Module', 'Lesson', 'Question', 'Rating'} model
 * @param {!Number} id
 * @param {!Blob|!BufferSource|!FormData|!URLSearchParams|!ReadableStream|!String} postData
 * @param {?String} contentType
 * @return {Promise<Response>} promise of updated object
 */function _create(){return _create=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function a(b){var c,d,e,f=arguments;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=1<f.length&&void 0!==f[1]?f[1]:"",a.prev=1,a.next=4,fetch("/api/".concat(b.toLowerCase(),"/create"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include",redirect:"follow",body:c,cache:"no-cache"});case 4:return d=a.sent,a.next=7,d.json();case 7:return e=a.sent,a.abrupt("return",e.result);case 11:return a.prev=11,a.t0=a["catch"](1),console.error(a.t0),a.abrupt("return",alert(a.t0.msg||a.t0.message||a.t0.toString()));case 15:case"end":return a.stop();}},a,this,[[1,11]])})),_create.apply(this,arguments)}function update(){return _update.apply(this,arguments)}/**
 * Destroy an object from the database.
 *
 * @param {'User', 'Module', 'Lesson', 'Question', 'Rating', 'File'} model
 * @param {!Number} id
 * @return {Promise<void|!String>}
 */function _update(){return _update=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function a(b,c,d){var e,f,g,h,i=arguments;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e=3<i.length&&void 0!==i[3]?i[3]:"application/json",f={Accept:"application/json, text/html, application/xhtml+xml, text/plain, *"},e&&(f["Content-Type"]=e),a.prev=3,a.next=6,fetch("/api/".concat(b.toLowerCase(),"/").concat(c),{method:"post",headers:f,credentials:"include",redirect:"follow",body:d,cache:"no-cache"});case 6:return g=a.sent,a.next=9,g.json();case 9:return h=a.sent,a.abrupt("return",400<=g.status?Promise.reject(h.msg):h.msg);case 13:return a.prev=13,a.t0=a["catch"](3),console.error(a.t0),a.abrupt("return",alert(a.t0.msg||a.t0.message||a.t0.toString()));case 17:case"end":return a.stop();}},a,this,[[3,13]])})),_update.apply(this,arguments)}function destroy(){return _destroy.apply(this,arguments)}function _destroy(){return _destroy=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function a(b,c){var d,e;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,fetch("/api/".concat(b.toLowerCase(),"/").concat(c),{method:"delete",headers:{Accept:"application/json"},credentials:"include",redirect:"follow",cache:"no-cache"});case 3:return d=a.sent,a.next=6,d.json();case 6:return e=a.sent,a.abrupt("return",e.msg);case 10:return a.prev=10,a.t0=a["catch"](0),console.error(a.t0),a.abrupt("return",alert(a.t0.msg||a.t0.message||a.t0.toString()));case 14:case"end":return a.stop();}},a,this,[[0,10]])})),_destroy.apply(this,arguments)}